(()=>{var e={};e.id=302,e.ids=[302],e.modules={742:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o,metadata:()=>n});var s=r(8433);r(3956);let n={title:"Kline Service",description:"K线图表服务"};function o({children:e}){return(0,s.jsx)("html",{lang:"zh-CN",children:(0,s.jsx)("body",{className:"font-sans",children:e})})}},765:()=>{},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},909:()=>{},2377:(e,t,r)=>{Promise.resolve().then(r.bind(r,7351))},2426:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>c,pages:()=>u,routeModule:()=>p,tree:()=>d});var s=r(1611),n=r(9044),o=r(1382),a=r.n(o),l=r(6465),i={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>l[e]);r.d(t,i);let d={children:["",{children:["(dashboard)",{children:["kline",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,5661)),"/Users/liushuo/code/ts-next-template/apps/kline-service/app/(dashboard)/kline/page.tsx"]}]},{}]},{"not-found":[()=>Promise.resolve().then(r.t.bind(r,7170,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,1475,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,4776,23)),"next/dist/client/components/unauthorized-error"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,742)),"/Users/liushuo/code/ts-next-template/apps/kline-service/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,7170,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,1475,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,4776,23)),"next/dist/client/components/unauthorized-error"]}]}.children,u=["/Users/liushuo/code/ts-next-template/apps/kline-service/app/(dashboard)/kline/page.tsx"],c={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/(dashboard)/kline/page",pathname:"/kline",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},2672:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,4928,23)),Promise.resolve().then(r.t.bind(r,9670,23)),Promise.resolve().then(r.t.bind(r,1382,23)),Promise.resolve().then(r.t.bind(r,5473,23)),Promise.resolve().then(r.t.bind(r,7429,23)),Promise.resolve().then(r.t.bind(r,8653,23)),Promise.resolve().then(r.t.bind(r,8757,23)),Promise.resolve().then(r.t.bind(r,9687,23))},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},3956:()=>{},5661:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var s=r(8433),n=r(7351);async function o(){return(0,s.jsx)(n.default,{})}},6865:(e,t,r)=>{"use strict";r.d(t,{default:()=>o});var s=r(9563),n=r(638);function o(){var e;let t;process.env.NEXT_PUBLIC_BASE_PATH;let r=(0,n.useRef)(null),o=(0,n.useRef)(null),a=(0,n.useRef)(null),l=(0,n.useRef)(null),i=(0,n.useRef)({lastFrameTime:0,frameCount:0,fps:0}),[d,u]=(0,n.useState)(!0),[c,p]=(0,n.useState)(null),[m,h]=(0,n.useState)("default"),[f,v]=(0,n.useState)(!1),[x,b]=(0,n.useState)(0),y=(0,n.useCallback)(e=>{if(!a.current)return null;let t=a.current.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}},[]),k=(0,n.useCallback)(e=>{l.current&&l.current.postMessage(e)},[]);(0,n.useCallback)(e=>{let t={initialized:()=>{if(!r.current||!o.current||!a.current){p("Canvas元素未找到"),u(!1);return}let t=r.current.transferControlToOffscreen(),s=o.current.transferControlToOffscreen(),n=a.current.transferControlToOffscreen();[t,s,n].forEach(e=>{e.width=1800,e.height=800}),e.postMessage({type:"draw",canvas:t,mainCanvas:s,overlayCanvas:n},[t,s,n])},drawComplete:()=>{u(!1)},error:e=>{p(e.error),u(!1)},cursorStyle:e=>{h(e.style)},mousedownHandled:e=>{e.handled&&v(!0)},mouseupHandled:e=>{e.isDragEnd&&v(!1)},mouseleaveHandled:e=>{e.needsRedraw&&v(!1)},clickHandled:e=>{e.modeChanged&&console.log("图表模式已切换")},performanceMetrics:e=>{e.renderTime&&console.log(`渲染时间: ${e.renderTime}ms`)}};e.onmessage=e=>{try{let r=t[e.data.type];r?r(e.data):console.warn(`未处理的消息类型: ${e.data.type}`)}catch(e){console.error("Worker消息处理错误:",e),p(`Worker消息处理错误: ${e instanceof Error?e.message:"未知错误"}`),u(!1)}}},[1800,800]);let P=(0,n.useCallback)(()=>{let e=performance.now(),t=i.current;t.frameCount++,e-t.lastFrameTime>=1e3&&(t.fps=Math.round(1e3*t.frameCount/(e-t.lastFrameTime)),t.frameCount=0,t.lastFrameTime=e,b(t.fps)),requestAnimationFrame(P)},[]),C=(0,n.useCallback)(e=>{let t=y(e);t&&(k({type:"mousemove",x:t.x,y:t.y}),k({type:"getCursorStyle",x:t.x,y:t.y}))},[y,k]),g=(0,n.useCallback)(()=>{k({type:"mouseleave"})},[k]),j=(0,n.useCallback)((e=e=>{k({type:"wheel",deltaY:e.deltaY,x:e.nativeEvent.offsetX,y:e.nativeEvent.offsetY,isDragging:f})},t=!1,function(...r){t||(e(...r),t=!0,setTimeout(()=>t=!1,20))}),[k,f]),w=(0,n.useCallback)(e=>{let t=y(e);t&&k({type:"mousedown",x:t.x,y:t.y})},[y,k]),_=(0,n.useCallback)(e=>{let t=y(e);t&&k({type:"mouseup",x:t.x,y:t.y})},[y,k]),N=(0,n.useCallback)(e=>{let t=y(e);t&&k({type:"mousedrag",x:t.x,y:t.y})},[y,k]),T=(0,n.useCallback)(e=>{let t=y(e);t&&k({type:"click",x:t.x,y:t.y})},[y,k]);return(0,n.useCallback)(e=>{console.error("K线图渲染错误:",e),p(`渲染错误: ${e.message}`),u(!1)},[]),(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"K 线图 (Web Worker + OffscreenCanvas)"}),(0,s.jsxs)("div",{className:"text-sm text-gray-600 mb-2",children:["性能: ",x," FPS"]}),d&&(0,s.jsxs)("div",{className:"p-4 flex items-center justify-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mr-2"}),"正在加载和处理 K 线数据..."]}),c&&(0,s.jsxs)("div",{className:"p-4 text-red-600",children:["错误: ",c]}),(0,s.jsxs)("div",{className:"relative m-0 border-0 p-0",style:{cursor:m,width:"1800px",height:"800px"},children:[(0,s.jsx)("canvas",{ref:r,className:"absolute top-0 left-0 m-0 border-0 p-0 z-10"}),(0,s.jsx)("canvas",{ref:o,className:"absolute top-0 left-0 w-full m-0 border-0 p-0 z-20 "}),(0,s.jsx)("canvas",{onMouseMove:f?N:C,onMouseLeave:g,onWheel:j,onMouseDown:w,onMouseUp:_,onClick:T,ref:a,className:"absolute top-0 left-0 w-full m-0 border-0 p-0 z-30 "})]})]})}},7351:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});let s=(0,r(807).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/liushuo/code/ts-next-template/apps/kline-service/app/(dashboard)/kline/main.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/liushuo/code/ts-next-template/apps/kline-service/app/(dashboard)/kline/main.tsx","default")},7529:(e,t,r)=>{Promise.resolve().then(r.bind(r,6865))},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9520:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,7774,23)),Promise.resolve().then(r.t.bind(r,9136,23)),Promise.resolve().then(r.t.bind(r,6996,23)),Promise.resolve().then(r.t.bind(r,767,23)),Promise.resolve().then(r.t.bind(r,5207,23)),Promise.resolve().then(r.t.bind(r,9855,23)),Promise.resolve().then(r.t.bind(r,8751,23)),Promise.resolve().then(r.t.bind(r,1681,23))}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[135,821],()=>r(2426));module.exports=s})();