"use strict";exports.id=578,exports.ids=[578],exports.modules={661:(e,t,r)=>{function a(e,t,...r){if((r=r.filter(Boolean)).length>2){let t=r.pop();e+=`one of type ${r.join(", ")}, or ${t}.`}else 2===r.length?e+=`one of type ${r[0]} or ${r[1]}.`:e+=`of type ${r[0]}.`;return null==t?e+=` Received ${t}`:"function"==typeof t&&t.name?e+=` Received function ${t.name}`:"object"==typeof t&&null!=t&&t.constructor?.name&&(e+=` Received an instance of ${t.constructor.name}`),e}r.d(t,{A:()=>n,t:()=>s});let n=(e,...t)=>a("Key must be ",e,...t);function s(e,t,...r){return a(`Key for the ${e} algorithm must be `,t,...r)}},1047:(e,t,r)=>{r.d(t,{$4:()=>p,BT:()=>d,Dm:()=>E,Dp:()=>l,Rb:()=>c,T0:()=>o,Ye:()=>i,_L:()=>u,h2:()=>f,i4:()=>a,ie:()=>n,n:()=>s,xb:()=>y});class a extends Error{static code="ERR_JOSE_GENERIC";code="ERR_JOSE_GENERIC";constructor(e,t){super(e,t),this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}class n extends a{static code="ERR_JWT_CLAIM_VALIDATION_FAILED";code="ERR_JWT_CLAIM_VALIDATION_FAILED";claim;reason;payload;constructor(e,t,r="unspecified",a="unspecified"){super(e,{cause:{claim:r,reason:a,payload:t}}),this.claim=r,this.reason=a,this.payload=t}}class s extends a{static code="ERR_JWT_EXPIRED";code="ERR_JWT_EXPIRED";claim;reason;payload;constructor(e,t,r="unspecified",a="unspecified"){super(e,{cause:{claim:r,reason:a,payload:t}}),this.claim=r,this.reason=a,this.payload=t}}class c extends a{static code="ERR_JOSE_ALG_NOT_ALLOWED";code="ERR_JOSE_ALG_NOT_ALLOWED"}class o extends a{static code="ERR_JOSE_NOT_SUPPORTED";code="ERR_JOSE_NOT_SUPPORTED"}class i extends a{static code="ERR_JWS_INVALID";code="ERR_JWS_INVALID"}class l extends a{static code="ERR_JWT_INVALID";code="ERR_JWT_INVALID"}class u extends a{static code="ERR_JWK_INVALID";code="ERR_JWK_INVALID"}class E extends a{static code="ERR_JWKS_INVALID";code="ERR_JWKS_INVALID"}class d extends a{static code="ERR_JWKS_NO_MATCHING_KEY";code="ERR_JWKS_NO_MATCHING_KEY";constructor(e="no applicable key found in the JSON Web Key Set",t){super(e,t)}}class p extends a{[Symbol.asyncIterator];static code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";constructor(e="multiple matching keys found in the JSON Web Key Set",t){super(e,t)}}class y extends a{static code="ERR_JWKS_TIMEOUT";code="ERR_JWKS_TIMEOUT";constructor(e="request timed out",t){super(e,t)}}class f extends a{static code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";constructor(e="signature verification failed",t){super(e,t)}}},2758:(e,t,r)=>{function a(e){if(Uint8Array.prototype.toBase64)return e.toBase64();let t=[];for(let r=0;r<e.length;r+=32768)t.push(String.fromCharCode.apply(null,e.subarray(r,r+32768)));return btoa(t.join(""))}function n(e){if(Uint8Array.fromBase64)return Uint8Array.fromBase64(e);let t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}r.d(t,{W:()=>a,y:()=>n})},3213:(e,t,r)=>{r.d(t,{A:()=>n});var a=r(1047);let n=async e=>{if(!e.alg)throw TypeError('"alg" argument is required when "jwk.alg" is not present');let{algorithm:t,keyUsages:r}=function(e){let t,r;switch(e.kty){case"RSA":switch(e.alg){case"PS256":case"PS384":case"PS512":t={name:"RSA-PSS",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":t={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":t={name:"RSA-OAEP",hash:`SHA-${parseInt(e.alg.slice(-3),10)||1}`},r=e.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new a.T0('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"EC":switch(e.alg){case"ES256":t={name:"ECDSA",namedCurve:"P-256"},r=e.d?["sign"]:["verify"];break;case"ES384":t={name:"ECDSA",namedCurve:"P-384"},r=e.d?["sign"]:["verify"];break;case"ES512":t={name:"ECDSA",namedCurve:"P-521"},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:"ECDH",namedCurve:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new a.T0('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"OKP":switch(e.alg){case"Ed25519":case"EdDSA":t={name:"Ed25519"},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new a.T0('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;default:throw new a.T0('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:t,keyUsages:r}}(e),n={...e};return delete n.alg,delete n.use,crypto.subtle.importKey("jwk",n,t,e.ext??!e.d,e.key_ops??r)}},5212:(e,t,r)=>{let a;r.d(t,{Og:()=>m,Lf:()=>g,jU:()=>R,Mh:()=>h});var n=r(5318),s=r(2758),c=r(1047);let o=(e,t)=>{let r=(e.match(/.{1,64}/g)||[]).join("\n");return`-----BEGIN ${t}-----
${r}
-----END ${t}-----`},i=(e,t,r=0)=>{0===r&&(t.unshift(t.length),t.unshift(6));let a=e.indexOf(t[0],r);if(-1===a)return!1;let n=e.subarray(a,a+t.length);return n.length===t.length&&(n.every((e,r)=>e===t[r])||i(e,t,a+1))},l=e=>{switch(!0){case i(e,[42,134,72,206,61,3,1,7]):return"P-256";case i(e,[43,129,4,0,34]):return"P-384";case i(e,[43,129,4,0,35]):return"P-521";default:return}},u=async(e,t,r,a,n)=>{let s,o,i=new Uint8Array(atob(r.replace(e,"")).split("").map(e=>e.charCodeAt(0))),u="spki"===t;switch(a){case"PS256":case"PS384":case"PS512":s={name:"RSA-PSS",hash:`SHA-${a.slice(-3)}`},o=u?["verify"]:["sign"];break;case"RS256":case"RS384":case"RS512":s={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${a.slice(-3)}`},o=u?["verify"]:["sign"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":s={name:"RSA-OAEP",hash:`SHA-${parseInt(a.slice(-3),10)||1}`},o=u?["encrypt","wrapKey"]:["decrypt","unwrapKey"];break;case"ES256":s={name:"ECDSA",namedCurve:"P-256"},o=u?["verify"]:["sign"];break;case"ES384":s={name:"ECDSA",namedCurve:"P-384"},o=u?["verify"]:["sign"];break;case"ES512":s={name:"ECDSA",namedCurve:"P-521"},o=u?["verify"]:["sign"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let e=l(i);s=e?.startsWith("P-")?{name:"ECDH",namedCurve:e}:{name:"X25519"},o=u?[]:["deriveBits"];break}case"Ed25519":case"EdDSA":s={name:"Ed25519"},o=u?["verify"]:["sign"];break;default:throw new c.T0('Invalid or unsupported "alg" (Algorithm) value')}return crypto.subtle.importKey(t,i,s,n?.extractable??!!u,o)},E=(e,t,r)=>u(/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,"pkcs8",e,t,r),d=(e,t,r)=>u(/(?:-----(?:BEGIN|END) PUBLIC KEY-----|\s)/g,"spki",e,t,r);function p(e){let t=[],r=0;for(;r<e.length;){let a=y(e.subarray(r));t.push(a),r+=a.byteLength}return t}function y(e){let t=0,r=31&e[0];if(t++,31===r){for(r=0;e[t]>=128;)r=128*r+e[t]-128,t++;r=128*r+e[t]-128,t++}let a=0;if(e[t]<128)a=e[t],t++;else if(128===a){for(a=0;0!==e[t+a]||0!==e[t+a+1];){if(a>e.byteLength)throw TypeError("invalid indefinite form length");a++}let r=t+a+2;return{byteLength:r,contents:e.subarray(t,t+a),raw:e.subarray(0,r)}}else{let r=127&e[t];t++,a=0;for(let n=0;n<r;n++)a=256*a+e[t],t++}let n=t+a;return{byteLength:n,contents:e.subarray(t,n),raw:e.subarray(0,n)}}let f=(e,t,r)=>{let n;try{n=function(e){try{a??=globalThis.process?.getBuiltinModule?.("node:crypto")?.createPublicKey}catch{a=0}if(a)try{return new a(e).export({format:"pem",type:"spki"})}catch{}let t=e.replace(/(?:-----(?:BEGIN|END) CERTIFICATE-----|\s)/g,"");return o(function(e){let t=p(p(y(e).contents)[0].contents);return(0,s.W)(t[160===t[0].raw[0]?6:5].raw)}((0,s.y)(t)),"PUBLIC KEY")}(e)}catch(e){throw TypeError("Failed to parse the X.509 certificate",{cause:e})}return d(n,t,r)};var S=r(3213),A=r(6159);async function R(e,t,r){if("string"!=typeof e||0!==e.indexOf("-----BEGIN PUBLIC KEY-----"))throw TypeError('"spki" must be SPKI formatted string');return d(e,t,r)}async function h(e,t,r){if("string"!=typeof e||0!==e.indexOf("-----BEGIN CERTIFICATE-----"))throw TypeError('"x509" must be X.509 formatted string');return f(e,t,r)}async function g(e,t,r){if("string"!=typeof e||0!==e.indexOf("-----BEGIN PRIVATE KEY-----"))throw TypeError('"pkcs8" must be PKCS#8 formatted string');return E(e,t,r)}async function m(e,t,r){let a;if(!(0,A.A)(e))throw TypeError("JWK must be an object");switch(t??=e.alg,a??=r?.extractable??e.ext,e.kty){case"oct":if("string"!=typeof e.k||!e.k)throw TypeError('missing "k" (Key Value) Parameter value');return(0,n.D)(e.k);case"RSA":if("oth"in e&&void 0!==e.oth)throw new c.T0('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return(0,S.A)({...e,alg:t,ext:a});default:throw new c.T0('Unsupported "kty" (Key Type) Parameter value')}}},5318:(e,t,r)=>{r.d(t,{D:()=>s,l:()=>c});var a=r(5937),n=r(2758);function s(e){if(Uint8Array.fromBase64)return Uint8Array.fromBase64("string"==typeof e?e:a.D0.decode(e),{alphabet:"base64url"});let t=e;t instanceof Uint8Array&&(t=a.D0.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return(0,n.y)(t)}catch{throw TypeError("The input to be decoded is not correctly encoded.")}}function c(e){let t=e;return("string"==typeof t&&(t=a.Rd.encode(t)),Uint8Array.prototype.toBase64)?t.toBase64({alphabet:"base64url",omitPadding:!0}):(0,n.W)(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}},5937:(e,t,r)=>{r.d(t,{D0:()=>n,Rd:()=>a,xW:()=>s});let a=new TextEncoder,n=new TextDecoder;function s(...e){let t=new Uint8Array(e.reduce((e,{length:t})=>e+t,0)),r=0;for(let a of e)t.set(a,r),r+=a.length;return t}},6159:(e,t,r)=>{r.d(t,{A:()=>a});let a=e=>{if(!function(e){return"object"==typeof e&&null!==e}(e)||"[object Object]"!==Object.prototype.toString.call(e))return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}},8851:(e,t,r)=>{function a(e){return e?.[Symbol.toStringTag]==="CryptoKey"}function n(e){return e?.[Symbol.toStringTag]==="KeyObject"}r.d(t,{Ay:()=>s,D2:()=>n,R7:()=>a});let s=e=>a(e)||n(e)}};