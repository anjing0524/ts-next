(()=>{var e={};e.id=872,e.ids=[872],e.modules={483:()=>{},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3117:(e,t,r)=>{"use strict";r.d(t,{FB:()=>l,Uj:()=>d});var s=r(7642),o=r(5807),n=r(5511);let i={randomUUID:n.randomUUID},a=new Uint8Array(256),u=a.length,c=[];for(let e=0;e<256;++e)c.push((e+256).toString(16).slice(1));let p=function(e,t,r){if(i.randomUUID&&!t&&!e)return i.randomUUID();let s=(e=e||{}).random??e.rng?.()??(u>a.length-16&&((0,n.randomFillSync)(a),u=0),a.slice(u,u+=16));if(s.length<16)throw Error("Random bytes length must be >= 16");if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){if((r=r||0)<0||r+16>t.length)throw RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[r+e]=s[e];return t}return function(e,t=0){return(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase()}(s)};function d(e){return async(t,r)=>{let n=p();t.requestId=n;try{return await e(t,r)}catch(r){let e=n||p();if(function(e,t,r){let s={timestamp:new Date().toISOString(),requestId:r||"N/A",message:e.message||"An unknown error occurred.",name:e.name||"Error"};t&&(s.url=t.url,s.method=t.method,s.ip=t.headers.get("x-forwarded-for")||t.headers.get("x-real-ip")||"unknown",s.userAgent=t.headers.get("user-agent")),e instanceof o.Cf?(s.code=e.code,s.status=e.status,e.context&&(s.context=e.context)):(s.code="UNHANDLED_EXCEPTION",s.status=500),e.stack&&(s.stack=e.stack.split("\n").map(e=>e.trim())),console.error(JSON.stringify(s,null,2))}(r,t,e),r instanceof o.Cf){let t=r.toApiResponse();return t.error&&(t.error.details={...t.error.details,requestId:e}),s.NextResponse.json(t,{status:r.status})}return s.NextResponse.json({success:!1,error:{code:"INTERNAL_SERVER_ERROR",message:"An unexpected internal server error occurred.",details:{requestId:e}}},{status:500})}}}function l(e){return async(t,...r)=>{try{return await e(t,...r)}catch(e){if(console.error("API route error:",e),e instanceof o.Cf)return s.NextResponse.json({success:!1,error:e.code,message:e.message},{status:e.status});return s.NextResponse.json({success:!1,error:"INTERNAL_SERVER_ERROR",message:"An unexpected error occurred"},{status:500})}}}},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4907:()=>{},5511:e=>{"use strict";e.exports=require("crypto")},5807:(e,t,r)=>{"use strict";r.d(t,{CE:()=>n,Cf:()=>o,Fw:()=>s,Pb:()=>u,gz:()=>p,j1:()=>c,v3:()=>a,yI:()=>i});var s=function(e){return e.InvalidRequest="invalid_request",e.InvalidClient="invalid_client",e.InvalidGrant="invalid_grant",e.UnauthorizedClient="unauthorized_client",e.UnsupportedGrantType="unsupported_grant_type",e.InvalidScope="invalid_scope",e.AccessDenied="access_denied",e.UnsupportedResponseType="unsupported_response_type",e.ServerError="server_error",e.TemporarilyUnavailable="temporarily_unavailable",e.InvalidToken="invalid_token",e.InsufficientScope="insufficient_scope",e}({});class o extends Error{constructor(e,t=500,r="INTERNAL_SERVER_ERROR",s){super(e),this.name=this.constructor.name,this.status=t,this.code=r,this.context=s}toApiResponse(){return{success:!1,error:{code:this.code,message:this.message,details:this.context}}}log(e=console,t){e.error({name:this.name,message:this.message,status:this.status,code:this.code,context:this.context,additionalContext:t,stack:this.stack})}}class n extends o{constructor(e="Resource not found.",t="RESOURCE_NOT_FOUND",r){super(e,404,t,r)}}class i extends o{constructor(e="Validation failed.",t,r="VALIDATION_ERROR"){super(e,400,r,t)}}class a extends o{constructor(e="Authentication failed.",t,r="AUTHENTICATION_FAILED"){super(e,401,r,t)}}class u extends o{constructor(e,t=400,r="TOKEN_ERROR",s){super(e,t,r,s)}}class c extends o{constructor(e="System configuration error.",t){super(e,500,"CONFIGURATION_ERROR",t)}}class p extends o{constructor(e,t,r=400,s,o){super(e,r,t,o),this.oauth2ErrorCode=t,this.errorUri=s}toOAuth2Response(){let e={error:this.oauth2ErrorCode,error_description:this.message};return this.errorUri&&(e.error_uri=this.errorUri),e}toApiResponse(){let e=super.toApiResponse();return e.error&&this.errorUri&&(e.error.details={...e.error.details,error_uri:this.errorUri}),e}}},8872:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>h,routeModule:()=>p,serverHooks:()=>_,workAsyncStorage:()=>d,workUnitAsyncStorage:()=>l});var s={};r.r(s),r.d(s,{GET:()=>c});var o=r(9227),n=r(9044),i=r(1131),a=r(7642);async function u(e){let t=function(e){let t=e.headers.get("x-forwarded-host")||e.headers.get("host")||e.nextUrl.host,r=e.headers.get("x-forwarded-proto")||e.nextUrl.protocol.slice(0,-1);return`${r}://${t}`}(e),r={issuer:process.env.JWT_ISSUER||t,authorization_endpoint:`${t}/api/v2/oauth/authorize`,token_endpoint:`${t}/api/v2/oauth/token`,introspection_endpoint:`${t}/api/v2/oauth/introspect`,revocation_endpoint:`${t}/api/v2/oauth/revoke`,jwks_uri:`${t}/api/v2/.well-known/jwks.json`,scopes_supported:["openid","profile","email","offline_access","api:read","api:write","user:read","user:write"],response_types_supported:["code"],grant_types_supported:["authorization_code","refresh_token","client_credentials"],token_endpoint_auth_methods_supported:["client_secret_basic","client_secret_post"],revocation_endpoint_auth_methods_supported:["client_secret_basic","client_secret_post"],introspection_endpoint_auth_methods_supported:["client_secret_basic","client_secret_post"],code_challenge_methods_supported:["S256"],userinfo_endpoint:`${t}/api/v2/oauth/userinfo`,subject_types_supported:["public"],id_token_signing_alg_values_supported:process.env.JWT_ALGORITHM?[process.env.JWT_ALGORITHM]:["RS256"],claims_supported:["sub","name","given_name","family_name","preferred_username","picture","updated_at","organization","department"]};return a.NextResponse.json(r,{status:200,headers:{"Content-Type":"application/json"}})}let c=(0,r(3117).FB)(u),p=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/v2/.well-known/openid-configuration/route",pathname:"/api/v2/.well-known/openid-configuration",filename:"route",bundlePath:"app/api/v2/.well-known/openid-configuration/route"},resolvedPagePath:"/Users/liushuo/code/ts-next-template/apps/oauth-service/app/api/v2/.well-known/openid-configuration/route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:d,workUnitAsyncStorage:l,serverHooks:_}=p;function h(){return(0,i.patchFetch)({workAsyncStorage:d,workUnitAsyncStorage:l})}},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[938],()=>r(8872));module.exports=s})();