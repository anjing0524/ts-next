services:
  - name: 'unified-gateway'
    bind_address: '0.0.0.0:6188'
    default_backend: 'admin-portal'
    backends:
      admin-portal:
        upstreams:
          - '127.0.0.1:3002'
        tls: false
      oauth-service:
        upstreams:
          - '127.0.0.1:3001'
        tls: false
    routes:
      - path_prefix: '/api/v2/oauth/'
        backend: 'oauth-service'
      - path_prefix: '/api/v2/auth/'
        backend: 'oauth-service'
      - path_prefix: '/api/v2/admin/'
        backend: 'oauth-service'
      - path_prefix: '/login'
        backend: 'admin-portal'
      - path_prefix: '/auth/'
        backend: 'admin-portal'
      - path_prefix: '/oauth/consent'
        backend: 'admin-portal'
    health_check:
      timeout_ms: 500
      frequency_secs: 5