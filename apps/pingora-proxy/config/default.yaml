services:
  - name: 'unified-gateway'
    bind_address: '0.0.0.0:6188'
    default_backend: 'admin-portal' # Default to admin-portal for all UI and non-API requests
    backends:
      admin-portal:
        upstreams:
          - '127.0.0.1:3002'
        tls: false
      oauth-service-rust:
        upstreams:
          - '127.0.0.1:3001'
        tls: false
    routes:
      # Route all API v2 traffic to the Rust OAuth service
      - path_prefix: '/api/v2/'
        backend: 'oauth-service-rust'
    health_check:
      timeout_ms: 500
      frequency_secs: 5
